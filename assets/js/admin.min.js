!function(a){function b(){if(0===o)g.css({width:"1%"});else{var a=parseInt(o)/parseInt(p)*100;g.css({width:a+"%"})}if("sync"===m)h.text("Syncing "+parseInt(o)+"/"+parseInt(p)),h.show(),g.show(),k.show(),f.addClass("syncing"),l.hide(),j.hide(),i.hide();else if("pause"===m)h.text("Syncing paused "+parseInt(o)+"/"+parseInt(p)),h.show(),g.show(),k.hide(),f.addClass("syncing"),l.show(),j.show(),i.hide();else if("error"===m){if(h.text("An error occured while syncing"),h.show(),i.show(),l.hide(),j.hide(),k.hide(),f.removeClass("syncing"),g.hide(),n){var b=e.find(".ep-module-"+n);b.removeClass("module-syncing")}setTimeout(function(){h.hide()},7e3)}else if("cancel"===m){if(h.hide(),g.hide(),k.hide(),f.removeClass("syncing"),l.hide(),j.hide(),i.show(),n){var b=e.find(".ep-module-"+n);b.removeClass("module-syncing")}}else if("finished"===m||"noposts"===m){if("noposts"===m?h.text("No posts to sync"):h.text("Sync complete"),g.hide(),k.hide(),l.hide(),j.hide(),i.show(),f.removeClass("syncing"),n){var b=e.find(".ep-module-"+n);b.removeClass("module-syncing")}setTimeout(function(){h.hide()},7e3)}}function c(){a.ajax({method:"post",url:ajaxurl,data:{action:"ep_cancel_index",nonce:ep.nonce}})}function d(){a.ajax({method:"post",url:ajaxurl,data:{action:"ep_index",module_sync:n,nonce:ep.nonce}}).done(function(a){"sync"===m&&(p=a.data.found_posts,o=a.data.offset,0===a.data.found_posts?a.data.start?(m="noposts",b()):(m="finished",b()):(m="sync",b(),d()))}).error(function(){m="error",b(),c()})}var e=a(document.getElementsByClassName("ep-modules")),f=a(".js-ep-wrap"),g=a(".progress-bar"),h=a(".sync-status"),i=a(".start-sync"),j=a(".resume-sync"),k=a(".pause-sync"),l=a(".cancel-sync"),m="sync",n=!1,o=0,p=0;e.on("click",".js-toggle-module",function(b){b.preventDefault();var c=b.target.getAttribute("data-module"),f=a(this);f.addClass("processing");var g=e.find(".ep-module-"+c);a.ajax({method:"post",url:ajaxurl,data:{action:"ep_toggle_module",module:c,nonce:ep.nonce}}).done(function(a){setTimeout(function(){f.removeClass("processing"),g.toggleClass("module-active"),a.data.active&&a.data.reindex&&(m="sync",g.addClass("module-syncing"),n=c,d())},700)}).error(function(){setTimeout(function(){f.removeClass("processing"),g.removeClass("module-active"),g.removeClass("module-syncing")},700)})}),ep.index_meta&&(o=ep.index_meta.offset,p=ep.index_meta.found_posts,0===p?response.data.start?(m="noposts",b()):(m="finished",b()):ep.auto_start_index?(m="sync",d()):(m="pause",b())),i.on("click",function(){m="sync",d()}),k.on("click",function(){m="pause",b()}),j.on("click",function(){m="sync",d()}),l.on("click",function(){m="cancel",b(),c()})}(jQuery);